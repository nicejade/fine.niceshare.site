class t extends HTMLElement{constructor(){super(),this._current=this.querySelector('a[aria-current="true"]'),this.minH=parseInt(this.dataset.minH||"2",10),this.maxH=parseInt(this.dataset.maxH||"3",10),this.onIdle=t=>(window.requestIdleCallback||(t=>setTimeout(t,1)))(t),this.init=()=>{const t=[...this.querySelectorAll("a")],e=t=>{if(t instanceof HTMLHeadingElement){if("_top"===t.id)return!0;const e=t.tagName[1];if(e){const t=parseInt(e,10);if(t>=this.minH&&t<=this.maxH)return!0}}return!1},n=t=>{if(!t)return null;const i=t;for(;t;){if(e(t))return t;for(t=t.previousElementSibling;t?.lastElementChild;)t=t.lastElementChild;const i=n(t);if(i)return i}return n(i.parentElement)},i=e=>{for(const{isIntersecting:i,target:r}of e){if(!i)continue;const e=n(r);if(!e)continue;const s=t.find((t=>t.hash==="#"+encodeURIComponent(e.id)));if(s){this.current=s;break}}},r=document.querySelectorAll("main [id], main [id] ~ *, main .content > *");let s;const o=()=>{s||(s=new IntersectionObserver(i,{rootMargin:this.getRootMargin()}),r.forEach((t=>s.observe(t))))};let c;o(),window.addEventListener("resize",(()=>{s&&(s.disconnect(),s=void 0),clearTimeout(c),c=setTimeout((()=>this.onIdle(o)),200)}))},this.onIdle((()=>this.init()))}set current(t){t!==this._current&&(this._current&&this._current.removeAttribute("aria-current"),t.setAttribute("aria-current","true"),this._current=t)}getRootMargin(){const t=(document.querySelector("header")?.getBoundingClientRect().height||0)+(this.querySelector("summary")?.getBoundingClientRect().height||0)+32;return`-${t}px 0% ${t+53-document.documentElement.clientHeight}px`}}customElements.define("starlight-toc",t);export{t as S};