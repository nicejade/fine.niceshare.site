const pagefind_version="1.4.0";let wasm_bindgen;!function(){const e={};let t,n;"undefined"!=typeof document&&null!==document.currentScript&&(t=new URL("UNHANDLED",location.href).toString());let r=0,a=null;function i(){return null!==a&&0!==a.byteLength||(a=new Uint8Array(n.memory.buffer)),a}const s="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},o="function"==typeof s.encodeInto?function(e,t){return s.encodeInto(e,t)}:function(e,t){const n=s.encode(e);return t.set(n),{read:e.length,written:n.length}};function l(e,t,n){if(void 0===n){const n=s.encode(e),a=t(n.length,1)>>>0;return i().subarray(a,a+n.length).set(n),r=n.length,a}let a=e.length,l=t(a,1)>>>0;const c=i();let d=0;for(;d<a;d++){const t=e.charCodeAt(d);if(t>127)break;c[l+d]=t}if(d!==a){0!==d&&(e=e.slice(d)),l=n(l,a,a=d+3*e.length,1)>>>0;const t=i().subarray(l+d,l+a);d+=o(e,t).written,l=n(l,a,d,1)>>>0}return r=d,l}function c(e,t){const n=t(1*e.length,1)>>>0;return i().set(e,n/1),r=e.length,n}e.set_ranking_weights=function(e,t){const a=l(t,n.__wbindgen_malloc,n.__wbindgen_realloc),i=r;return n.set_ranking_weights(e,a,i)>>>0},e.init_pagefind=function(e){const t=c(e,n.__wbindgen_malloc),a=r;return n.init_pagefind(t,a)>>>0},e.load_filter_chunk=function(e,t){const a=c(t,n.__wbindgen_malloc),i=r;return n.load_filter_chunk(e,a,i)>>>0};let d=null;function h(){return null!==d&&0!==d.byteLength||(d=new Int32Array(n.memory.buffer)),d}const f="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function u(e,t){return e>>>=0,f.decode(i().subarray(e,e+t))}function g(){const e={wbg:{}};return e}function _(e,t){return n=e.exports,p.__wbindgen_wasm_module=t,d=null,a=null,n}async function p(e){if(void 0!==n)return n;void 0===e&&void 0!==t&&(e=t.replace(/\.js$/,"_bg.wasm"));const r=g();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:a,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,r);return _(a,i)}"undefined"!=typeof TextDecoder&&f.decode(),e.request_filter_indexes=function(e,t){let a,i;try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=l(t,n.__wbindgen_malloc,n.__wbindgen_realloc),f=r;n.request_filter_indexes(c,e,d,f);var s=h()[c/4+0],o=h()[c/4+1];return a=s,i=o,u(s,o)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(a,i,1)}},e.request_indexes=function(e,t){let a,i;try{const c=n.__wbindgen_add_to_stack_pointer(-16),d=l(t,n.__wbindgen_malloc,n.__wbindgen_realloc),f=r;n.request_indexes(c,e,d,f);var s=h()[c/4+0],o=h()[c/4+1];return a=s,i=o,u(s,o)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(a,i,1)}},e.request_all_filter_indexes=function(e){let t,r;try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.request_all_filter_indexes(s,e);var a=h()[s/4+0],i=h()[s/4+1];return t=a,r=i,u(a,i)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r,1)}},e.filters=function(e){let t,r;try{const s=n.__wbindgen_add_to_stack_pointer(-16);n.filters(s,e);var a=h()[s/4+0],i=h()[s/4+1];return t=a,r=i,u(a,i)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(t,r,1)}},e.enter_playground_mode=function(e){return n.enter_playground_mode(e)>>>0},e.search=function(e,t,a,i,s){let o,c;try{const g=n.__wbindgen_add_to_stack_pointer(-16),_=l(t,n.__wbindgen_malloc,n.__wbindgen_realloc),p=r,w=l(a,n.__wbindgen_malloc,n.__wbindgen_realloc),m=r,b=l(i,n.__wbindgen_malloc,n.__wbindgen_realloc),y=r;n.search(g,e,_,p,w,m,b,y,s);var d=h()[g/4+0],f=h()[g/4+1];return o=d,c=f,u(d,f)}finally{n.__wbindgen_add_to_stack_pointer(16),n.__wbindgen_free(o,c,1)}},e.add_synthetic_filter=function(e,t){const a=l(t,n.__wbindgen_malloc,n.__wbindgen_realloc),i=r;return n.add_synthetic_filter(e,a,i)>>>0},e.load_index_chunk=function(e,t){const a=c(t,n.__wbindgen_malloc),i=r;return n.load_index_chunk(e,a,i)>>>0},wasm_bindgen=Object.assign(p,{initSync:function(e){if(void 0!==n)return n;const t=g();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),_(new WebAssembly.Instance(e,t),e)}},e)}();var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var n=new u16(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var a=new u32(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)a[i]=i-n[r]<<5|r;return[n,a]},_a=freb(fleb,2),fl=_a[0],revfl=_a[1];fl[28]=258,revfl[258]=28;var x,_b=freb(fdeb,0),fd=_b[0],revfd=_b[1],rev=new u16(32768);for(i=0;i<32768;++i)x=(61680&(x=(52428&(x=(43690&i)>>>1|(21845&i)<<1))>>>2|(13107&x)<<2))>>>4|(3855&x)<<4,rev[i]=((65280&x)>>>8|(255&x)<<8)>>>1;var hMap=function(e,t,n){for(var r=e.length,a=0,i=new u16(t);a<r;++a)e[a]&&++i[e[a]-1];var s,o=new u16(t);for(a=0;a<t;++a)o[a]=o[a-1]+i[a-1]<<1;if(n){s=new u16(1<<t);var l=15-t;for(a=0;a<r;++a)if(e[a])for(var c=a<<4|e[a],d=t-e[a],h=o[e[a]-1]++<<d,f=h|(1<<d)-1;h<=f;++h)s[rev[h]>>>l]=c}else for(s=new u16(r),a=0;a<r;++a)e[a]&&(s[a]=rev[o[e[a]-1]++]>>>15-e[a]);return s},flt=new u8(288);for(i=0;i<144;++i)flt[i]=8;for(i=144;i<256;++i)flt[i]=9;for(i=256;i<280;++i)flt[i]=7;for(i=280;i<288;++i)flt[i]=8;var i,fdt=new u8(32);for(i=0;i<32;++i)fdt[i]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},bits=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},bits16=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},shft=function(e){return(e+7)/8|0},slc=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(2==e.BYTES_PER_ELEMENT?u16:4==e.BYTES_PER_ELEMENT?u32:u8)(n-t);return r.set(e.subarray(t,n)),r},ec=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],err=function(e,t,n){var r=new Error(t||ec[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,err),!n)throw r;return r},inflt=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new u8(0);var a=!t||n,i=!n||n.i;n||(n={}),t||(t=new u8(3*r));var s=function(e){var n=t.length;if(e>n){var r=new u8(Math.max(2*n,e));r.set(t),t=r}},o=n.f||0,l=n.p||0,c=n.b||0,d=n.l,h=n.d,f=n.m,u=n.n,g=8*r;do{if(!d){o=bits(e,l,1);var _=bits(e,l+1,3);if(l+=3,!_){var p=e[(F=shft(l)+4)-4]|e[F-3]<<8,w=F+p;if(w>r){i&&err(0);break}a&&s(c+p),t.set(e.subarray(F,w),c),n.b=c+=p,n.p=l=8*w,n.f=o;continue}if(1==_)d=flrm,h=fdrm,f=9,u=5;else if(2==_){var m=bits(e,l,31)+257,b=bits(e,l+10,15)+4,y=m+bits(e,l+5,31)+1;l+=14;for(var v=new u8(y),P=new u8(19),x=0;x<b;++x)P[clim[x]]=bits(e,l+3*x,7);l+=3*b;var k=max(P),S=(1<<k)-1,$=hMap(P,k,1);for(x=0;x<y;){var F,U=$[bits(e,l,S)];if(l+=15&U,(F=U>>>4)<16)v[x++]=F;else{var L=0,M=0;for(16==F?(M=3+bits(e,l,3),l+=2,L=v[x-1]):17==F?(M=3+bits(e,l,7),l+=3):18==F&&(M=11+bits(e,l,127),l+=7);M--;)v[x++]=L}}var A=v.subarray(0,m),E=v.subarray(m);f=max(A),u=max(E),d=hMap(A,f,1),h=hMap(E,u,1)}else err(1);if(l>g){i&&err(0);break}}a&&s(c+131072);for(var W=(1<<f)-1,I=(1<<u)-1,D=l;;D=l){var C=(L=d[bits16(e,l)&W])>>>4;if((l+=15&L)>g){i&&err(0);break}if(L||err(2),C<256)t[c++]=C;else{if(256==C){D=l,d=null;break}var T=C-254;if(C>264){var j=fleb[x=C-257];T=bits(e,l,(1<<j)-1)+fl[x],l+=j}var O=h[bits16(e,l)&I],R=O>>>4;O||err(3),l+=15&O;E=fd[R];if(R>3){j=fdeb[R];E+=bits16(e,l)&(1<<j)-1,l+=j}if(l>g){i&&err(0);break}a&&s(c+131072);for(var N=c+T;c<N;c+=4)t[c]=t[c-E],t[c+1]=t[c+1-E],t[c+2]=t[c+2-E],t[c+3]=t[c+3-E];c=N}}n.l=d,n.p=D,n.b=c,n.f=o,d&&(o=1,n.m=f,n.d=h,n.n=u)}while(!o);return c==t.length?t:slc(t,0,c)},et=new u8(0),gzs=function(e){31==e[0]&&139==e[1]&&8==e[2]||err(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=e[10]|2+(e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},gzl=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0};function gunzipSync(e,t){return inflt(e.subarray(gzs(e),-8),t||new u8(gzl(e)))}var td="undefined"!=typeof TextDecoder&&new TextDecoder,tds=0;try{td.decode(et,{stream:!0}),tds=1}catch(e){}var gz_default=gunzipSync,calculate_excerpt_region=(e,t)=>{if(0===e.length)return 0;let n=[];for(const t of e)n[t.location]=n[t.location]||0,n[t.location]+=t.balanced_score;if(n.length<=t)return 0;let r=n.slice(0,t).reduce(((e,t)=>e+t),0),a=r,i=[0];for(let e=0;e<n.length;e++){a+=(n[e+t]??0)-(n[e]??0),a>r?(r=a,i=[e]):a===r&&i[i.length-1]===e-1&&i.push(e)}return i[Math.floor(i.length/2)]},build_excerpt=(e,t,n,r,a,i)=>{let s=e.includes("​"),o=[];o=s?e.split("​"):e.split(/[\r\n\s]+/g);for(let e of r)o[e]?.startsWith("<mark>")||(o[e]=`<mark>${o[e]}</mark>`);let l=i??o.length,c=a??0;return l-c<n&&(n=l-c),t+n>l&&(t=l-n),t<c&&(t=c),o.slice(t,t+n).join(s?"":" ").trim()},calculate_sub_results=(e,t)=>{const n=e.anchors.filter((e=>/h\d/i.test(e.element)&&e.text?.length&&/\S/.test(e.text))).sort(((e,t)=>e.location-t.location)),r=[];let a=0,i={title:e.meta.title,url:e.url,weighted_locations:[],locations:[],excerpt:""};const s=n=>{if(i.locations.length){const s=i.weighted_locations.map((e=>({weight:e.weight,balanced_score:e.balanced_score,location:e.location-a}))),o=calculate_excerpt_region(s,t)+a,l=n?Math.min(n-o,t):t;i.excerpt=build_excerpt(e.raw_content??"",o,l,i.locations,a,n),r.push(i)}};for(let t of e.weighted_locations)if(!n.length||t.location<n[0].location)i.weighted_locations.push(t),i.locations.push(t.location);else{let r=n.shift();for(s(r.location);n.length&&t.location>=n[0].location;)r=n.shift();let o=e.url;try{if(/^((https?:)?\/\/)/.test(o)){let e=new URL(o);e.hash=r.id,o=e.toString()}else{/^\//.test(o)||(o=`/${o}`);let e=new URL(`https://example.com${o}`);e.hash=r.id,o=e.toString().replace(/^https:\/\/example.com/,"")}}catch(e){console.error(`Pagefind: Couldn't process ${o} for a search result`)}a=r.location,i={title:r.text,url:o,anchor:r,weighted_locations:[t],locations:[t.location],excerpt:""}}return s(n[0]?.location),r},asyncSleep=async(e=100)=>new Promise((t=>setTimeout(t,e))),isBrowser="undefined"!=typeof window&&"undefined"!=typeof document,PagefindInstance=class{constructor(e={}){this.version="1.4.0",this.backend=wasm_bindgen,this.decoder=new TextDecoder("utf-8"),this.wasm=null,this.basePath=e.basePath||"/pagefind/",this.primary=e.primary||!1,this.primary&&!e.basePath&&this.initPrimary(),/[^\/]$/.test(this.basePath)&&(this.basePath=`${this.basePath}/`),isBrowser&&window?.location?.origin&&this.basePath.startsWith(window.location.origin)&&(this.basePath=this.basePath.replace(window.location.origin,"")),this.baseUrl=e.baseUrl||this.defaultBaseUrl(),/^(\/|https?:\/\/)/.test(this.baseUrl)||(this.baseUrl=`/${this.baseUrl}`),this.indexWeight=e.indexWeight??1,this.excerptLength=e.excerptLength??30,this.mergeFilter=e.mergeFilter??{},this.ranking=e.ranking,this.highlightParam=e.highlightParam??null,this.loaded_chunks={},this.loaded_filters={},this.loaded_fragments={},this.raw_ptr=null,this.searchMeta=null,this.languages=null}initPrimary(){if(isBrowser&&void 0!==import.meta.url){let e=import.meta.url.match(/^(.*\/)pagefind.js.*$/)?.[1];e?this.basePath=e:console.warn(["Pagefind couldn't determine the base of the bundle from the import path. Falling back to the default.","Set a basePath option when initialising Pagefind to ignore this message."].join("\n"))}}defaultBaseUrl(){let e=this.basePath.match(/^(.*\/)_?pagefind/)?.[1];return e||"/"}async options(e){const t=["basePath","baseUrl","indexWeight","excerptLength","mergeFilter","highlightParam","ranking"];for(const[n,r]of Object.entries(e))if("mergeFilter"===n){let e=this.stringifyFilters(r),t=await this.getPtr();this.raw_ptr=this.backend.add_synthetic_filter(t,e)}else"ranking"===n?await this.set_ranking(e.ranking):t.includes(n)?("basePath"===n&&"string"==typeof r&&(this.basePath=r),"baseUrl"===n&&"string"==typeof r&&(this.baseUrl=r),"indexWeight"===n&&"number"==typeof r&&(this.indexWeight=r),"excerptLength"===n&&"number"==typeof r&&(this.excerptLength=r),"mergeFilter"===n&&"object"==typeof r&&(this.mergeFilter=r),"highlightParam"===n&&"string"==typeof r&&(this.highlightParam=r)):console.warn(`Unknown Pagefind option ${n}. Allowed options: [${t.join(", ")}]`)}async enterPlaygroundMode(){let e=await this.getPtr();this.raw_ptr=this.backend.enter_playground_mode(e)}decompress(e,t="unknown file"){return"pagefind_dcd"===this.decoder.decode(e.slice(0,12))?e.slice(12):(e=gz_default(e),"pagefind_dcd"!==this.decoder.decode(e.slice(0,12))?(console.error(`Decompressing ${t} appears to have failed: Missing signature`),e):e.slice(12))}async set_ranking(e){if(!e)return;let t={term_similarity:e.termSimilarity??null,page_length:e.pageLength??null,term_saturation:e.termSaturation??null,term_frequency:e.termFrequency??null},n=await this.getPtr();this.raw_ptr=this.backend.set_ranking_weights(n,JSON.stringify(t))}async init(e,t){await this.loadEntry();let n=this.findIndex(e),r=n.wasm?n.wasm:"unknown";this.loadedLanguage=e;let a=[this.loadMeta(n.hash)];if(!0===t.load_wasm&&a.push(this.loadWasm(r)),await Promise.all(a),this.raw_ptr=this.backend.init_pagefind(new Uint8Array(this.searchMeta)),Object.keys(this.mergeFilter)?.length){let e=this.stringifyFilters(this.mergeFilter),t=await this.getPtr();this.raw_ptr=this.backend.add_synthetic_filter(t,e)}this.ranking&&await this.set_ranking(this.ranking)}async loadEntry(){try{let e=await fetch(`${this.basePath}pagefind-entry.json?ts=${Date.now()}`),t=await e.json();this.languages=t.languages,this.loadedVersion=t.version,this.includeCharacters=t.include_characters??[],t.version!==this.version&&(this.primary?console.warn(["Pagefind JS version doesn't match the version in your search index.",`Pagefind JS: ${this.version}. Pagefind index: ${t.version}`,"If you upgraded Pagefind recently, you likely have a cached pagefind.js file.","If you encounter any search errors, try clearing your cache."].join("\n")):console.warn(["Merging a Pagefind index from a different version than the main Pagefind instance.",`Main Pagefind JS: ${this.version}. Merged index (${this.basePath}): ${t.version}`,"If you encounter any search errors, make sure that both sites are running the same version of Pagefind."].join("\n")))}catch(e){throw console.error(`Failed to load Pagefind metadata:\n${e?.toString()}`),new Error("Failed to load Pagefind metadata")}}findIndex(e){if(this.languages){let t=this.languages[e];if(t)return t;if(t=this.languages[e.split("-")[0]],t)return t;let n=Object.values(this.languages).sort(((e,t)=>t.page_count-e.page_count));if(n[0])return n[0]}throw new Error("Pagefind Error: No language indexes found.")}async loadMeta(e){try{let t=await fetch(`${this.basePath}pagefind.${e}.pf_meta`),n=await t.arrayBuffer();this.searchMeta=this.decompress(new Uint8Array(n),"Pagefind metadata")}catch(e){console.error(`Failed to load the meta index:\n${e?.toString()}`)}}async loadWasm(e){try{const t=`${this.basePath}wasm.${e}.pagefind`;let n=await fetch(t),r=await n.arrayBuffer();const a=this.decompress(new Uint8Array(r),"Pagefind WebAssembly");if(!a)throw new Error("No WASM after decompression");this.wasm=await this.backend(a)}catch(e){throw console.error(`Failed to load the Pagefind WASM:\n${e?.toString()}`),new Error(`Failed to load the Pagefind WASM:\n${e?.toString()}`)}}async _loadGenericChunk(e,t){try{let n=await fetch(e),r=await n.arrayBuffer(),a=this.decompress(new Uint8Array(r),e),i=await this.getPtr();this.raw_ptr=this.backend[t](i,a)}catch(t){console.error(`Failed to load the index chunk ${e}:\n${t?.toString()}`)}}async loadChunk(e){if(!this.loaded_chunks[e]){const t=`${this.basePath}index/${e}.pf_index`;this.loaded_chunks[e]=this._loadGenericChunk(t,"load_index_chunk")}return await this.loaded_chunks[e]}async loadFilterChunk(e){if(!this.loaded_filters[e]){const t=`${this.basePath}filter/${e}.pf_filter`;this.loaded_filters[e]=this._loadGenericChunk(t,"load_filter_chunk")}return await this.loaded_filters[e]}async _loadFragment(e){let t=await fetch(`${this.basePath}fragment/${e}.pf_fragment`),n=await t.arrayBuffer(),r=this.decompress(new Uint8Array(n),`Fragment ${e}`);return JSON.parse((new TextDecoder).decode(r))}async loadFragment(e,t=[],n){this.loaded_fragments[e]||(this.loaded_fragments[e]=this._loadFragment(e));let r=await this.loaded_fragments[e];r.weighted_locations=t,r.locations=t.map((e=>e.location)),r.raw_content||(r.raw_content=r.content.replace(/</g,"&lt;").replace(/>/g,"&gt;"),r.content=r.content.replace(/\u200B/g,"")),r.raw_url||(r.raw_url=r.url),r.url=this.processedUrl(r.raw_url,n);const a=calculate_excerpt_region(t,this.excerptLength);return r.excerpt=build_excerpt(r.raw_content,a,this.excerptLength,r.locations),r.sub_results=calculate_sub_results(r,this.excerptLength),r}fullUrl(e){return/^(https?:)?\/\//.test(e)?e:`${this.baseUrl}/${e}`.replace(/\/+/g,"/").replace(/^(https?:\/)/,"$1/")}processedUrl(e,t){const n=this.fullUrl(e);if(null===this.highlightParam)return n;let r=t.split(/\s+/);try{let e=new URL(n);for(const t of r)e.searchParams.append(this.highlightParam,t);return e.toString()}catch(e){try{let e=new URL(`https://example.com${n}`);for(const t of r)e.searchParams.append(this.highlightParam,t);return e.toString().replace(/^https:\/\/example\.com/,"")}catch(e){return n}}}async getPtr(){for(;null===this.raw_ptr;)await asyncSleep(50);if(!this.raw_ptr)throw console.error("Pagefind: WASM Error (No pointer)"),new Error("Pagefind: WASM Error (No pointer)");return this.raw_ptr}stringifyFilters(e={}){return JSON.stringify(e)}stringifySorts(e={}){let t=Object.entries(e);for(let[e,n]of t)return t.length>1&&console.warn(`Pagefind was provided multiple sort options in this search, but can only operate on one. Using the ${e} sort.`),"asc"!==n&&"desc"!==n&&console.warn(`Pagefind was provided a sort with unknown direction ${n}. Supported: [asc, desc]`),`${e}:${n}`;return""}async filters(){let e=await this.getPtr(),t=this.backend.request_all_filter_indexes(e),n=JSON.parse(t);if(Array.isArray(n)){let e=n.filter((e=>e)).map((e=>this.loadFilterChunk(e)));await Promise.all([...e])}e=await this.getPtr();let r=this.backend.filters(e);return JSON.parse(r)}async preload(e,t={}){await this.search(e,{...t,preload:!0})}async search(e,t={}){t={verbose:!1,filters:{},sort:{},...t};const n=e=>{t.verbose&&console.log(e)};n(`Starting search on ${this.basePath}`);let r=Date.now(),a=await this.getPtr(),i=null===e,s=/^\s*".+"\s*$/.test(e=e??"");s&&n("Running an exact search");let o=null;try{o=Intl.getCanonicalLocales(this.loadedLanguage)[0]}catch(e){}const l=[];let c;if(o&&void 0!==Intl.Segmenter){c=[...new Intl.Segmenter(o,{granularity:"grapheme"}).segment(e)].map((({segment:e})=>e))}else c=[...e];for(const e of c)this.includeCharacters?.includes(e)?l.push(e):/^\p{Pd}|\p{Pe}|\p{Pf}|\p{Pi}|\p{Po}|\p{Ps}$/u.test(e)||l.push(e.toLocaleLowerCase());if(n(`Normalized search term to ${e=l.join("").replace(/\s{2,}/g," ").trim()}`),!e?.length&&!i)return{results:[],unfilteredResultCount:0,filters:{},totalFilters:{},timings:{preload:Date.now()-r,search:Date.now()-r,total:Date.now()-r}};let d=this.stringifySorts(t.sort);n(`Stringified sort to ${d}`);const h=this.stringifyFilters(t.filters);n(`Stringified filters to ${h}`);let f=this.backend.request_indexes(a,e),u=JSON.parse(f),g=this.backend.request_filter_indexes(a,h),_=JSON.parse(g),p=u.filter((e=>e)).map((e=>this.loadChunk(e))),w=_.filter((e=>e)).map((e=>this.loadFilterChunk(e)));if(await Promise.all([...p,...w]),n("Loaded necessary chunks to run search"),t.preload)return n("Preload — bailing out of search operation now."),null;a=await this.getPtr();let m=Date.now(),b=this.backend.search(a,e,h,d,s);n(`Got the raw search result: ${b}`);let{filtered_counts:y,total_counts:v,results:P,unfiltered_total:x,search_keywords:k}=JSON.parse(b),S=P.map((t=>{let n=t.l.map((e=>{let t={weight:e.w/24,balanced_score:e.s,location:e.l};return e.v&&(t.verbose={word_string:e.v.ws,length_bonus:e.v.lb}),t})),r=n.map((e=>e.location)),a={id:t.p,score:t.s*this.indexWeight,words:r,data:async()=>await this.loadFragment(t.p,n,e)};return t.params&&(a.params={document_length:t.params.dl,average_page_length:t.params.apl,total_pages:t.params.tp}),t.scores&&(a.scores=t.scores.map((e=>({search_term:e.w,idf:e.idf,saturating_tf:e.b_tf,raw_tf:e.r_tf,pagefind_tf:e.p_tf,score:e.s,params:{weighted_term_frequency:e.params.w_tf,pages_containing_term:e.params.pct,length_bonus:e.params.lb}})))),a}));const $=Date.now()-m,F=Date.now()-r;n(`Found ${P.length} result${1==P.length?"":"s"} for "${e}" in ${Date.now()-m}ms (${Date.now()-r}ms realtime)`);let U={results:S,unfilteredResultCount:x,filters:y,totalFilters:v,timings:{preload:F-$,search:$,total:F}};return k&&(U.search_keywords=k),U}},Pagefind=class{constructor(e={}){this.backend=wasm_bindgen,this.primaryLanguage="unknown",this.searchID=0,this.primary=new PagefindInstance({...e,primary:!0}),this.instances=[this.primary],this.init(e?.language)}async options(e){await this.primary.options(e)}async enterPlaygroundMode(){await this.primary.enterPlaygroundMode()}async init(e){if(isBrowser&&document?.querySelector){const e=document.querySelector("html")?.getAttribute("lang")||"unknown";this.primaryLanguage=e.toLocaleLowerCase()}await this.primary.init(e||this.primaryLanguage,{load_wasm:!0})}async mergeIndex(e,t={}){if(this.primary.basePath.startsWith(e))return void console.warn(`Skipping mergeIndex ${e} that appears to be the same as the primary index (${this.primary.basePath})`);let n=new PagefindInstance({primary:!1,basePath:e});for(this.instances.push(n);null===this.primary.wasm;)await asyncSleep(50);await n.init(t.language||this.primaryLanguage,{load_wasm:!1}),delete t.language,await n.options(t)}mergeFilters(e){const t={};for(const n of e)for(const[e,r]of Object.entries(n))if(t[e]){const n=t[e];for(const[e,t]of Object.entries(r))n[e]=(n[e]||0)+t}else t[e]=r;return t}async filters(){let e=await Promise.all(this.instances.map((e=>e.filters())));return this.mergeFilters(e)}async preload(e,t={}){await Promise.all(this.instances.map((n=>n.preload(e,t))))}async debouncedSearch(e,t,n){const r=++this.searchID;if(this.preload(e,t),await asyncSleep(n),r!==this.searchID)return null;const a=await this.search(e,t);return r!==this.searchID?null:a}async search(e,t={}){let n=await Promise.all(this.instances.map((n=>n.search(e,t))));const r=this.mergeFilters(n.map((e=>e.filters))),a=this.mergeFilters(n.map((e=>e.totalFilters))),i=n.map((e=>e.results)).flat().sort(((e,t)=>t.score-e.score)),s=n.map((e=>e.timings));let o={results:i,unfilteredResultCount:n.reduce(((e,t)=>e+t.unfilteredResultCount),0),filters:r,totalFilters:a,timings:s};return n[0].search_keywords&&(o.search_keywords=n[0].search_keywords),o}},pagefind=void 0,initial_options=void 0,init_pagefind=()=>{pagefind||(pagefind=new Pagefind(initial_options??{}))},options=async e=>{pagefind?await pagefind.options(e):initial_options=e},init=async()=>{init_pagefind()},destroy=async()=>{pagefind=void 0,initial_options=void 0},mergeIndex=async(e,t)=>(init_pagefind(),await pagefind.mergeIndex(e,t)),search=async(e,t)=>(init_pagefind(),await pagefind.search(e,t)),debouncedSearch=async(e,t,n=300)=>(init_pagefind(),await pagefind.debouncedSearch(e,t,n)),preload=async(e,t)=>(init_pagefind(),await pagefind.preload(e,t)),filters=async()=>(init_pagefind(),await pagefind.filters());export{debouncedSearch,destroy,filters,init,mergeIndex,options,preload,search};